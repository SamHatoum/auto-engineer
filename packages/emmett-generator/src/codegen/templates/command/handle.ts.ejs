import { CommandHandler, type EventStore } from '@event-driven-io/emmett';
import { evolve } from './evolve';
import { initialState } from './state';
import { decide } from './decide';
import type { <%= pascalCase(commands[0].type) %> } from './commands';

const commandHandler = CommandHandler({
evolve,
initialState,
});

export const handle = async (
eventStore: EventStore,
command: <%= pascalCase(commands[0].type) %>
): Promise<void> => {
    const streamId = '<%= streamId %>';

    await commandHandler(eventStore, streamId, (state) =>
    decide(command, state)
    );
    };