{
  "variant": "specs",
  "flows": [
    {
      "name": "Beautiful Questionnaire App",
      "id": "AUTO-EUVNoohRE",
      "slices": [
        {
          "name": "App Structure",
          "id": "AUTO-k6JkQZQnc",
          "type": "experience",
          "client": {
            "specs": {
              "name": "",
              "rules": [
                "display persistent sidebar on left for navigation",
                "sidebar includes links: Home, Create Survey, Analytics, Templates, Completion Tracker, Response Goals, Response History",
                "highlight current active link in sidebar",
                "sidebar collapsible for smaller screens",
                "top bar includes app logo, profile menu, and notifications icon",
                "bottom or top persistent bar shows global widgets: total responses, active surveys, completion rate progress",
                "content area changes dynamically based on selected navigation link",
                "maintain layout consistency across all screens",
                "support responsive design with sidebar collapsing into hamburger menu on mobile"
              ]
            }
          }
        },
        {
          "name": "Home Screen",
          "id": "AUTO-aifPcU3hw",
          "type": "experience",
          "client": {
            "specs": {
              "name": "",
              "rules": [
                "show active surveys summary and response rate overview",
                "display recent survey responses list",
                "show visual progress of completion rate goals",
                "quick access buttons for Create Survey, Analytics, Templates"
              ]
            }
          }
        },
        {
          "name": "Create Survey",
          "id": "AUTO-MPviTMrQC",
          "type": "experience",
          "client": {
            "specs": {
              "name": "",
              "rules": [
                "allow entering survey title, description, and question types",
                "show recent/frequent question templates for quick selection",
                "display confirmation toast after creating survey",
                "update survey dashboard and analytics in real-time"
              ]
            }
          }
        },
        {
          "name": "Response Analytics",
          "id": "AUTO-eME978Euk",
          "type": "experience",
          "client": {
            "specs": {
              "name": "",
              "rules": [
                "show daily and weekly response rate charts",
                "highlight surveys with highest engagement",
                "allow filtering by survey type or date range",
                "update dynamically when new responses are received"
              ]
            }
          }
        },
        {
          "name": "Manage Templates",
          "id": "AUTO-TRJBgM1JS",
          "type": "experience",
          "client": {
            "specs": {
              "name": "",
              "rules": [
                "list all survey templates with usage count and last modified date",
                "allow creating, editing, and deleting survey templates",
                "show monthly summary of template usage statistics",
                "highlight most popular and recently used templates"
              ]
            }
          }
        },
        {
          "name": "Survey Completion Tracker",
          "id": "AUTO-oDBBOUNzr",
          "type": "experience",
          "client": {
            "specs": {
              "name": "",
              "rules": [
                "show current completion rate and target progress",
                "allow setting completion rate targets",
                "automatically track new survey completions",
                "display visual completion progress bar consistently in shell"
              ]
            }
          }
        },
        {
          "name": "Response Goals Tracker",
          "id": "AUTO-Idmim68Yf",
          "type": "experience",
          "client": {
            "specs": {
              "name": "",
              "rules": [
                "allow setting monthly/weekly response targets",
                "show remaining response targets as a progress bar",
                "highlight underperforming surveys",
                "update in real-time when responses are received"
              ]
            }
          }
        },
        {
          "name": "Response History",
          "id": "AUTO-cIpwPlqRq",
          "type": "experience",
          "client": {
            "specs": {
              "name": "",
              "rules": [
                "allow viewing full response history",
                "filter by survey type, date, or completion status",
                "view detailed response data and export individual responses",
                "show contribution of each response to daily/weekly/monthly engagement totals"
              ]
            }
          }
        }
      ],
      "sourceFile": "/Users/osamatanveer/Desktop/Work/auto-engineer/examples/questionnaires/flows/homepage.flow.ts"
    },
    {
      "name": "Questionnaires",
      "id": "AUTO-Q9m2Kp4Lx",
      "slices": [
        {
          "name": "Homepage",
          "id": "AUTO-H1a4Bn6Cy",
          "type": "experience",
          "client": {
            "specs": {
              "name": "",
              "rules": ["show a hero section with a welcome message", "allow user to start the questionnaire"]
            }
          }
        },
        {
          "name": "views the questionnaire",
          "id": "AUTO-V7n8Rq5M",
          "type": "query",
          "client": {
            "description": "",
            "specs": {
              "name": "Questionnaire Progress",
              "rules": [
                "focus on the current question based on the progress state",
                "display the list of answered questions",
                "display the list of remaining questions",
                "show a progress indicator that is always visible as the user scrolls"
              ]
            }
          },
          "request": "query QuestionnaireProgress($participantId: ID!) {\n  questionnaireProgress(participantId: $participantId) {\n    questionnaireId\n    participantId\n    currentQuestionId\n    remainingQuestions\n    status\n    answers {\n      questionId\n      value\n    }\n  }\n}",
          "server": {
            "description": "",
            "data": [
              {
                "target": {
                  "type": "State",
                  "name": "QuestionnaireProgress"
                },
                "origin": {
                  "type": "projection",
                  "name": "Questionnaires",
                  "idField": "questionnaire-participantId"
                }
              }
            ],
            "specs": {
              "name": "",
              "rules": [
                {
                  "id": "AUTO-r1A3Bp9W",
                  "description": "questionnaires show current progress",
                  "examples": [
                    {
                      "description": "a question has already been answered",
                      "given": [
                        {
                          "eventRef": "QuestionnaireLinkSent",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "link": "https://app.example.com/q/q-001?participant=participant-abc",
                            "sentAt": "2030-01-01T09:00:00.000Z"
                          }
                        }
                      ],
                      "when": {
                        "exampleData": {
                          "questionnaireId": "q-001",
                          "participantId": "participant-abc",
                          "questionId": "q1",
                          "answer": "Yes",
                          "savedAt": "2030-01-01T09:05:00.000Z"
                        },
                        "eventRef": "QuestionAnswered"
                      },
                      "then": [
                        {
                          "stateRef": "QuestionnaireProgress",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "status": "in_progress",
                            "currentQuestionId": "q2",
                            "remainingQuestions": ["q2", "q3"],
                            "answers": [
                              {
                                "questionId": "q1",
                                "value": "Yes"
                              }
                            ]
                          }
                        }
                      ]
                    },
                    {
                      "description": "no questions have been answered yet",
                      "given": [
                        {
                          "eventRef": "QuestionnaireLinkSent",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "link": "https://app.example.com/q/q-001?participant=participant-abc",
                            "sentAt": "2030-01-01T09:00:00.000Z"
                          }
                        }
                      ],
                      "when": {
                        "eventRef": "",
                        "exampleData": {}
                      },
                      "then": [
                        {
                          "stateRef": "QuestionnaireProgress",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "status": "in_progress",
                            "currentQuestionId": "q1",
                            "remainingQuestions": ["q1", "q2", "q3"],
                            "answers": []
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "name": "submits a questionnaire answer",
          "id": "AUTO-S4j6Nt8Z",
          "type": "command",
          "client": {
            "description": "",
            "specs": {
              "name": "Submissions",
              "rules": [
                "displays a success message when the answer is submitted",
                "display an error message when the answer submission is rejected"
              ]
            }
          },
          "request": "mutation AnswerQuestion($input: AnswerQuestionInput!) {\n  answerQuestion(input: $input) {\n    success\n  }\n}",
          "server": {
            "description": "",
            "data": [
              {
                "target": {
                  "type": "Event",
                  "name": "QuestionAnswered"
                },
                "destination": {
                  "type": "stream",
                  "pattern": "questionnaire-participantId"
                }
              },
              {
                "target": {
                  "type": "Event",
                  "name": "QuestionnaireEditRejected"
                },
                "destination": {
                  "type": "stream",
                  "pattern": "questionnaire-participantId"
                }
              }
            ],
            "specs": {
              "name": "",
              "rules": [
                {
                  "id": "AUTO-r2D5Eq0Y",
                  "description": "answers are allowed while the questionnaire has not been submitted",
                  "examples": [
                    {
                      "description": "no questions have been answered yet",
                      "when": {
                        "commandRef": "AnswerQuestion",
                        "exampleData": {
                          "questionnaireId": "q-001",
                          "participantId": "participant-abc",
                          "questionId": "q1",
                          "answer": "Yes"
                        }
                      },
                      "then": [
                        {
                          "eventRef": "QuestionAnswered",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "questionId": "q1",
                            "answer": "Yes",
                            "savedAt": "2030-01-01T09:05:00.000Z"
                          }
                        }
                      ]
                    },
                    {
                      "description": "all questions have already been answered and submitted",
                      "given": [
                        {
                          "eventRef": "QuestionnaireSubmitted",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "submittedAt": "2030-01-01T09:00:00.000Z"
                          }
                        }
                      ],
                      "when": {
                        "commandRef": "AnswerQuestion",
                        "exampleData": {
                          "questionnaireId": "q-001",
                          "participantId": "participant-abc",
                          "questionId": "q1",
                          "answer": "Yes"
                        }
                      },
                      "then": [
                        {
                          "eventRef": "QuestionnaireEditRejected",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "reason": "Questionnaire already submitted",
                            "attemptedAt": "2030-01-01T09:05:00.000Z"
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "name": "questionnaire ready for submission",
          "id": "AUTO-R3f7Hu1X",
          "type": "query",
          "client": {
            "description": "",
            "specs": {
              "name": "Submission Readiness",
              "rules": [
                "enable the submit button when all questions are answered",
                "disable the submit button when all questions have not been answered"
              ]
            }
          },
          "request": "query QuestionnaireProgress($participantId: ID!) {\n  questionnaireProgress(participantId: $participantId) {\n    questionnaireId\n    participantId\n    status\n    currentQuestionId\n    remainingQuestions\n    answers {\n      questionId\n      value\n    }\n  }\n}",
          "server": {
            "description": "",
            "data": [
              {
                "target": {
                  "type": "State",
                  "name": "QuestionnaireProgress"
                },
                "origin": {
                  "type": "projection",
                  "name": "Questionnaires",
                  "idField": "questionnaire-participantId"
                }
              },
              {
                "target": {
                  "type": "State",
                  "name": "QuestionnaireConfig"
                },
                "origin": {
                  "type": "database",
                  "collection": "QuestionnaireConfigAPI"
                }
              }
            ],
            "specs": {
              "name": "",
              "rules": [
                {
                  "id": "AUTO-r3G8Iv2W",
                  "description": "questionnaire is ready for submission when all questions are answered",
                  "examples": [
                    {
                      "description": "all questions have been answered",
                      "given": [
                        {
                          "stateRef": "QuestionnaireConfig",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "numberOfQuestions": 2
                          }
                        },
                        {
                          "eventRef": "QuestionnaireLinkSent",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "link": "https://app.example.com/q/q-001?participant=participant-abc",
                            "sentAt": "2030-01-01T09:00:00.000Z"
                          }
                        },
                        {
                          "eventRef": "QuestionAnswered",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "questionId": "q1",
                            "answer": "Yes",
                            "savedAt": "2030-01-01T09:05:00.000Z"
                          }
                        },
                        {
                          "eventRef": "QuestionAnswered",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "questionId": "q2",
                            "answer": "No",
                            "savedAt": "2030-01-01T09:05:00.000Z"
                          }
                        }
                      ],
                      "when": {
                        "eventRef": "",
                        "exampleData": {}
                      },
                      "then": [
                        {
                          "stateRef": "QuestionnaireProgress",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "status": "ready_to_submit",
                            "currentQuestionId": null,
                            "remainingQuestions": [],
                            "answers": [
                              {
                                "questionId": "q1",
                                "value": "Yes"
                              },
                              {
                                "questionId": "q2",
                                "value": "No"
                              }
                            ]
                          }
                        }
                      ]
                    },
                    {
                      "description": "some questions are still unanswered",
                      "given": [
                        {
                          "eventRef": "QuestionnaireLinkSent",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "link": "https://app.example.com/q/q-001?participant=participant-abc",
                            "sentAt": "2030-01-01T09:00:00.000Z"
                          }
                        }
                      ],
                      "when": {
                        "exampleData": {
                          "questionnaireId": "q-001",
                          "participantId": "participant-abc",
                          "questionId": "q1",
                          "answer": "Yes",
                          "savedAt": "2030-01-01T09:05:00.000Z"
                        },
                        "eventRef": "QuestionAnswered"
                      },
                      "then": [
                        {
                          "stateRef": "QuestionnaireProgress",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "status": "in_progress",
                            "currentQuestionId": "q2",
                            "remainingQuestions": ["q2", "q3"],
                            "answers": [
                              {
                                "questionId": "q1",
                                "value": "Yes"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "name": "submits the questionnaire",
          "id": "AUTO-T5k9Jw3V",
          "type": "command",
          "client": {
            "description": "",
            "specs": {
              "name": "Submission Confirmation",
              "rules": ["display a confirmation message upon successful submission"]
            }
          },
          "request": "mutation SubmitQuestionnaire($input: SubmitQuestionnaireInput!) {\n  submitQuestionnaire(input: $input) {\n    success\n  }\n}",
          "server": {
            "description": "",
            "data": [
              {
                "target": {
                  "type": "Event",
                  "name": "QuestionnaireSubmitted"
                },
                "destination": {
                  "type": "stream",
                  "pattern": "questionnaire-participantId"
                }
              }
            ],
            "specs": {
              "name": "",
              "rules": [
                {
                  "id": "AUTO-r4H0Lx4U",
                  "description": "questionnaire allowed to be submitted when all questions are answered",
                  "examples": [
                    {
                      "description": "submits the questionnaire successfully",
                      "when": {
                        "commandRef": "SubmitQuestionnaire",
                        "exampleData": {
                          "questionnaireId": "q-001",
                          "participantId": "participant-abc"
                        }
                      },
                      "then": [
                        {
                          "eventRef": "QuestionnaireSubmitted",
                          "exampleData": {
                            "questionnaireId": "q-001",
                            "participantId": "participant-abc",
                            "submittedAt": "2030-01-01T09:00:00.000Z"
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        }
      ],
      "sourceFile": "/Users/osamatanveer/Desktop/Work/auto-engineer/examples/questionnaires/flows/questionnaires.flow.ts"
    }
  ],
  "messages": [
    {
      "type": "event",
      "name": "QuestionnaireLinkSent",
      "fields": [
        {
          "name": "questionnaireId",
          "type": "string",
          "required": true
        },
        {
          "name": "participantId",
          "type": "string",
          "required": true
        },
        {
          "name": "link",
          "type": "string",
          "required": true
        },
        {
          "name": "sentAt",
          "type": "Date",
          "required": true
        }
      ],
      "source": "internal",
      "metadata": {
        "version": 1
      }
    },
    {
      "type": "event",
      "name": "QuestionAnswered",
      "fields": [
        {
          "name": "questionnaireId",
          "type": "string",
          "required": true
        },
        {
          "name": "participantId",
          "type": "string",
          "required": true
        },
        {
          "name": "questionId",
          "type": "string",
          "required": true
        },
        {
          "name": "answer",
          "type": "unknown",
          "required": true
        },
        {
          "name": "savedAt",
          "type": "Date",
          "required": true
        }
      ],
      "source": "internal",
      "metadata": {
        "version": 1
      }
    },
    {
      "type": "state",
      "name": "QuestionnaireProgress",
      "fields": [
        {
          "name": "questionnaireId",
          "type": "string",
          "required": true
        },
        {
          "name": "participantId",
          "type": "string",
          "required": true
        },
        {
          "name": "status",
          "type": "\"in_progress\" | \"ready_to_submit\" | \"submitted\"",
          "required": true
        },
        {
          "name": "currentQuestionId",
          "type": "string | null",
          "required": true
        },
        {
          "name": "remainingQuestions",
          "type": "Array<string>",
          "required": true
        },
        {
          "name": "answers",
          "type": "Array<{ questionId: string; value: unknown }>",
          "required": true
        }
      ],
      "metadata": {
        "version": 1
      }
    },
    {
      "type": "command",
      "name": "AnswerQuestion",
      "fields": [
        {
          "name": "questionnaireId",
          "type": "string",
          "required": true
        },
        {
          "name": "participantId",
          "type": "string",
          "required": true
        },
        {
          "name": "questionId",
          "type": "string",
          "required": true
        },
        {
          "name": "answer",
          "type": "unknown",
          "required": true
        }
      ],
      "metadata": {
        "version": 1
      }
    },
    {
      "type": "event",
      "name": "QuestionnaireSubmitted",
      "fields": [
        {
          "name": "questionnaireId",
          "type": "string",
          "required": true
        },
        {
          "name": "participantId",
          "type": "string",
          "required": true
        },
        {
          "name": "submittedAt",
          "type": "Date",
          "required": true
        }
      ],
      "source": "internal",
      "metadata": {
        "version": 1
      }
    },
    {
      "type": "event",
      "name": "QuestionnaireEditRejected",
      "fields": [
        {
          "name": "questionnaireId",
          "type": "string",
          "required": true
        },
        {
          "name": "participantId",
          "type": "string",
          "required": true
        },
        {
          "name": "reason",
          "type": "string",
          "required": true
        },
        {
          "name": "attemptedAt",
          "type": "Date",
          "required": true
        }
      ],
      "source": "internal",
      "metadata": {
        "version": 1
      }
    },
    {
      "type": "state",
      "name": "QuestionnaireConfig",
      "fields": [
        {
          "name": "questionnaireId",
          "type": "string",
          "required": true
        },
        {
          "name": "numberOfQuestions",
          "type": "number",
          "required": true
        }
      ],
      "metadata": {
        "version": 1
      }
    },
    {
      "type": "command",
      "name": "SubmitQuestionnaire",
      "fields": [
        {
          "name": "questionnaireId",
          "type": "string",
          "required": true
        },
        {
          "name": "participantId",
          "type": "string",
          "required": true
        }
      ],
      "metadata": {
        "version": 1
      }
    }
  ],
  "integrations": []
}
